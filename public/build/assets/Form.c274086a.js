import{r as u,R as e,u as W,d as M}from"./app.64e4ef59.js";import{S as X}from"./sweetalert2.all.05d7ce78.js";import{d as ye,S as Ce,F as Y}from"./react-select.esm.cd0a4d41.js";import{Y as b}from"./index.26894aa4.js";import{h as N}from"./Permissions.6c5ad196.js";import"./typeof.2a08ffa3.js";import"./objectWithoutPropertiesLoose.a7a57350.js";import"./cst-visit.b44e8428.js";function C(l){return l?(l=l.replace(/^\s+|\s+$/g,""),l=l.toLowerCase(),l=l.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),l):null}function P(l){for(var s=l.replaceAll("-"," ").replaceAll("_"," ").split(" "),d=0;d<s.length;d++){var p=s[d];s[d]=p.charAt(0).toUpperCase()+p.slice(1)}return s.join(" ")}const y=l=>{let s=[];for(const d in l)s.push({key:d,value:l[d]});return s};function ke({data:l,setData:s}){const[d,p]=u.exports.useState(l.pages[0].page_title),o=n=>{let a=[];for(const r in n)(r!=="page"||r!=="page_title")&&a.push({key:r,value:n[r]});return a.filter(r=>r.key!=="page").filter(r=>r.key!=="page_title")},m=(n,a,r)=>{let i=l;i.pages[n][a]=r.target.value,s(b.stringify({...i,pages:[...i.pages.map(c=>({...c})).filter(c=>c.page!==n),...i.pages.filter(c=>c.page===n).map(c=>({...c}))].sort((c,v)=>c.page-v.page)}))};return e.createElement("div",{className:""},e.createElement("ul",{className:"nav nav-pills",id:"pills-tab",role:"tablist"},l.pages.map((n,a)=>e.createElement("li",{key:a,className:"nav-item"},e.createElement("a",{className:`nav-link ${d===n.page_title&&"active"}`,id:`pills-${C(n==null?void 0:n.page_title)}-tab`,type:"button",onClick:()=>p(n.page_title)},n.page_title)))),e.createElement("div",{className:"tab-content"},l.pages.map((n,a)=>e.createElement("div",{key:a,className:`tab-pane fade ${d===n.page_title&&"active show"} pe-3 ps-3`,id:`pills-${C(n.page_title)}`,role:"tabpanel","aria-labelledby":`pills-${C(n.page_title)}-tab`},o(n).map((r,i)=>e.createElement("div",{key:i,className:"mb-3 mt-3"},e.createElement("div",{className:"fw-bold"},P(r.key)),l.pages[a][r.key].length<20?e.createElement("input",{className:"form-control",value:l.pages[a][r.key],onChange:c=>m(a,r.key,c)}):e.createElement("textarea",{className:"form-control",value:l.pages[a][r.key],onChange:c=>m(a,r.key,c),rows:3})))))))}function xe({data:l,setData:s}){const d=y(l.features);u.exports.useState(l.pages[0].page_title);const[p,o]=u.exports.useState(y(l.features)[0].key),m=(a,r,i)=>{let c=l;c.features[a].data[r]=i.target.value,s(b.stringify(c))},n=(a,r,i)=>{let c=l;c.features[a].data[r]=b.parse(i),s(b.stringify(c))};return e.createElement("div",{className:""},e.createElement("ul",{className:"nav nav-pills",id:"pills-tab",role:"tablist"},d.map((a,r)=>e.createElement("div",{key:r},a.value.is_enabled===!0&&e.createElement("li",{key:r,className:"nav-item"},e.createElement("a",{className:`nav-link ${p===a.key&&"active"}`,id:`pills-${C(a.key)}-tab`,type:"button",onClick:()=>o(a.key)},P(a.key)))))),e.createElement("div",{className:"tab-content"},d.map((a,r)=>e.createElement("div",{key:r,className:`tab-pane fade ${p===a.key&&"active show"} pe-3 ps-3`,id:`pills-${C(a.key)}`,role:"tabpanel","aria-labelledby":`pills-${C(a.key)}-tab`},y(a.value.data).map((i,c)=>e.createElement("div",{key:c,className:"mb-3 mt-3"},e.createElement("div",{className:"fw-bold"},P(i.key)),typeof y(a.value.data)[c].value=="string"?e.createElement(e.Fragment,null,y(a.value.data)[c].value.length<20?e.createElement("input",{className:"form-control",value:l.features[a.key].data[i.key],onChange:v=>m(a.key,i.key,v)}):e.createElement("textarea",{className:"form-control",value:l.features[a.key].data[i.key],onChange:v=>m(a.key,i.key,v),rows:3})):typeof y(a.value.data)[c].value=="object"?e.createElement(ye,{height:"300px",defaultLanguage:"yaml",value:b.stringify(l.features[a.key].data[i.key]),theme:"vs-dark",onChange:v=>n(a.key,i.key,v)}):null))))))}function Ae({header:l,isEdit:s}){var j,z,O,q,G,H,J,Q;const{url:d}=W(),{auth:p,errors:o,invitation:m,templates:n,custom_templates:a,client:r,reseller:i}=W().props,c=n==null?void 0:n.map(t=>({label:t.name,value:t.id})),[v,Z]=u.exports.useState(s?m.title:""),[I,K]=u.exports.useState(s?m.slug:""),[T,ee]=u.exports.useState(s?m.status:"draft"),[D,te]=u.exports.useState(s?m.thumbnail:""),[F,ae]=u.exports.useState(s?m.excerpt:""),[k,le]=u.exports.useState(s?m.is_custom_template:!1),[B,_e]=u.exports.useState(s?m.is_custom_template:!1),[V,Se]=u.exports.useState(s?m.is_custom_template:!1),[$,_]=u.exports.useState(s?(j=m.custom_template)==null?void 0:j.template:(z=n[0])==null?void 0:z.template),[L,S]=u.exports.useState(s?(O=m.custom_template)==null?void 0:O.css:(q=n[0])==null?void 0:q.css),[x,h]=u.exports.useState(s?(G=m.custom_template)==null?void 0:G.content:(H=n[0])==null?void 0:H.content),[g,se]=u.exports.useState(s?m.template_id:(J=c[0])==null?void 0:J.value),[R,ne]=u.exports.useState(s?m.client_id:""),[ce,re]=u.exports.useState(s?r==null?void 0:r.username:""),[A,me]=u.exports.useState(s?m.reseller_id:""),[oe,ie]=u.exports.useState(s?i==null?void 0:i.username:""),[w,ue]=u.exports.useState(!1);u.exports.useEffect(()=>{},[]);function de(t,E){_(t)}function pe(t,E){S(t)}function ve(t,E){h(t)}const fe=()=>{_(n.filter(t=>t.id===g)[0].template)},be=()=>{S(n.filter(t=>t.id===g)[0].css)},he=()=>{h(n.filter(t=>t.id===g)[0].content)};function ge(t){se(t.value);const E=n.filter(U=>U.id==t.value)[0],f=a?a==null?void 0:a.filter(U=>U.template_id===t.value):[];console.log(f),(f==null?void 0:f.length)===0?(_(E.template),S(E.css),h(E.content)):(f==null?void 0:f.length)!=0&&(_(f[0].template),S(f[0].css),h(f[0].content))}const Ee=async t=>{t.preventDefault(),M.Inertia.post("/account/invitations",{title:v,slug:I,status:T,thumbnail:D,excerpt:F,template_id:g,is_custom_template:k,is_custom_css:B,is_custom_content:V,custom_template:$,custom_css:L,custom_content:x,user_id:p.user.id,client_id:R,reseller_id:A},{onSuccess:()=>{X.fire({title:"Success!",text:"Data saved successfully!",icon:"success",showConfirmButton:!1,timer:1500})}})},Ne=async t=>{t.preventDefault(),M.Inertia.put(`/account/invitations/${m.id}`,{title:v,slug:I,status:T,thumbnail:D,excerpt:F,template_id:g,is_custom_template:k,is_custom_css:B,is_custom_content:V,custom_template:$,custom_css:L,custom_content:x,user_id:p.user.id,client_id:R,reseller_id:A},{onSuccess:()=>{M.Inertia.visit(d,{},{preserveState:!0}),X.fire({title:"Success!",text:"Data saved successfully!",icon:"success",showConfirmButton:!1,timer:1500})}})};return e.createElement("div",{className:"row mt-4"},e.createElement("div",{className:"col-12"},e.createElement("div",{className:"card border-0 shadow-sm border-top-success"},e.createElement("div",{className:"card-header"},e.createElement("span",{className:"font-weight-bold"}," ",l)),e.createElement("div",{className:"card-body"},e.createElement("form",{onSubmit:s?Ne:Ee},N(["invitations.change-reseller"])&&e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Reseller"),e.createElement("input",{type:"text",className:"form-control",value:A,onChange:t=>me(t.target.value),placeholder:"Reseller Id"}),e.createElement("input",{type:"text",className:"form-control mt-2",value:oe,onChange:t=>ie(t.target.value),placeholder:"Reseller Username"})),N(["invitations.change-client"])&&e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Client"),e.createElement("input",{type:"text",className:"form-control",value:R,onChange:t=>ne(t.target.value),placeholder:"Client Id"}),e.createElement("input",{type:"text",className:"form-control mt-2",value:ce,onChange:t=>re(t.target.value),placeholder:"Client Username"})),o.title&&e.createElement("div",{className:"alert alert-danger"},o.title),e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Title"),e.createElement("input",{type:"text",className:"form-control",value:v,onChange:t=>Z(t.target.value),placeholder:"Enter Title"})),o.title&&e.createElement("div",{className:"alert alert-danger"},o.title),e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Slug"),e.createElement("input",{type:"text",className:"form-control",value:I,onChange:t=>K(t.target.value),placeholder:"Enter Slug",disabled:!N(["invitations.change-slug"])})),o.slug&&e.createElement("div",{className:"alert alert-danger"},o.slug),e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Status"),e.createElement("select",{className:"form-select",value:T,onChange:t=>ee(t.target.value),disabled:!N(["invitations.change-status"])},e.createElement("option",{value:"draft"},"Draft"),e.createElement("option",{value:"published"},"Published"),e.createElement("option",{value:"expired"},"Expired"))),o.status&&e.createElement("div",{className:"alert alert-danger"},o.status),e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Thumbnail"),e.createElement("input",{type:"text",className:"form-control",value:D,onChange:t=>te(t.target.value),placeholder:"Enter Thumbnail"})),o.thumbnail&&e.createElement("div",{className:"alert alert-danger"},o.thumbnail),e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Excerpt"),e.createElement("textarea",{type:"text",className:"form-control",value:F,onChange:t=>ae(t.target.value),placeholder:"Enter Excerpt"})),o.excerpt&&e.createElement("div",{className:"alert alert-danger"},o.excerpt),N(["invitations.change-template"])?e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Select Template"),e.createElement(Ce,{className:"basic-single",classNamePrefix:"select",defaultValue:c[0],value:c.filter(t=>t.value==g),isSearchable:!0,name:"template",options:c,onChange:t=>ge(t)})):e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"fw-bold"},"Select Template"),e.createElement("select",{className:"form-select",defaultValue:c.filter(t=>t.value===m.template_id)[0].label,disabled:!N(["invitations.change-template"])},e.createElement("option",null,c.filter(t=>t.value===m.template_id)[0].label))),o.template_id&&e.createElement("div",{className:"alert alert-danger"},o.template_id),((Q=["admin","operator"].filter(t=>t===p.user.roles[0].name))==null?void 0:Q.length)>0?e.createElement("div",{className:"d-flex"},e.createElement("div",{className:"form-check form-switch mb-3"},e.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:w,onChange:t=>ue(t.target.checked)}),e.createElement("label",{className:"form-check-label",for:"flexSwitchCheckDefault"},"Switch to YAML Editor"))):null,w&&e.createElement(e.Fragment,null,e.createElement("div",{className:"mb-3"},e.createElement("div",{className:"d-flex align-items-center mb-2"},e.createElement("label",{className:"fw-bold"},"Invitation Content"),e.createElement("div",{className:"btn btn-sm btn-success",style:{marginLeft:"12px"},onClick:he},"Reset")),e.createElement(Y,{height:"300px",defaultLanguage:"yaml",value:x,theme:"vs-dark",onChange:ve})),e.createElement("div",{className:"d-flex"},e.createElement("div",{className:"form-check form-switch mb-3"},e.createElement("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",checked:k,onChange:t=>le(t.target.checked)}),e.createElement("label",{className:"form-check-label",for:"flexSwitchCheckDefault"},"Enable Custom Template"))),k==!0&&e.createElement("div",{className:"mb-3"},e.createElement("div",{className:"d-flex align-items-center mb-2"},e.createElement("label",{className:"fw-bold"},"Custom Template"),e.createElement("div",{className:"btn btn-sm btn-success",style:{marginLeft:"12px"},onClick:fe},"Reset")),e.createElement(Y,{height:"300px",defaultLanguage:"yaml",value:$,theme:"vs-dark",onChange:de})),o.custom_template&&e.createElement("div",{className:"alert alert-danger"},o.custom_template),k==!0&&e.createElement("div",{className:"mb-3"},e.createElement("div",{className:"d-flex align-items-center mb-2"},e.createElement("label",{className:"fw-bold"},"Custom CSS"),e.createElement("div",{className:"btn btn-sm btn-success",style:{marginLeft:"12px"},onClick:be},"Reset")),e.createElement(Y,{height:"300px",defaultLanguage:"css",value:L,theme:"vs-dark",onChange:pe})),o.custom_css&&e.createElement("div",{className:"alert alert-danger"},o.custom_css)),!w&&e.createElement("div",{className:"card"},e.createElement("div",{className:"card-header"},e.createElement("div",{className:"fw-bold"},"Invitation Content")),e.createElement("div",{className:"card-body"},e.createElement(ke,{data:b.parse(x),setData:h}))),!w&&e.createElement("div",{className:"card mt-4"},e.createElement("div",{className:"card-header"},e.createElement("div",{className:"fw-bold"},"Invitation Features")),e.createElement("div",{className:"card-body"},e.createElement(xe,{data:b.parse(x),setData:h}))),e.createElement("div",{className:"position-fixed d-flex",style:{top:"70px",right:"20px"}},e.createElement("button",{type:"submit",className:"btn btn-md btn-success me-2"},e.createElement("i",{className:"fa fa-save"})," ",s?"Update":"Save")))))))}export{Ae as default};
